COPY START 0

WRITBUF MACRO &PARAM
LDA #3
+JSUB INPUT
FIX
IF (&PARAM LE 3)
ADD #TEN
ENDIF
LABL:TIXR A
MEND

READBUF MACRO &INDEV,&BUFADR,&RECLTH
CLEAR A
CLEAR X
TIXR T
ADDR  A,T
ADD THREE
TD =X'&INDEV'
ADD X&RECLTH->1
ADD X&RECLTH->2
STAR:ADD &BUFADR
JEQ STAR
MEND

SBUF MACRO
CLEAR X
CLEAR A
MEND

ORG 1000
TEST:READBUF F1,BUFFER,A
WRITBUF THREE
TEST3:SBUF
NUMBER EQU 1
LENGTH RESW 1
THREE WORD 3
TEN WORD 10
EOF BYTE X'05'
MAXLEN RESW 2
BUFFER RESW 4096
END COPY
